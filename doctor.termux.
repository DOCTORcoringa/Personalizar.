#!/usr/bin/env python3
import os

def escolher_lista_pergunta(pergunta, opcoes):
    print(pergunta)
    for i, opcao in enumerate(opcoes, 1):
        print(f"{i}) {opcao}")
    while True:
        escolha = input(f"Digite o número (1-{len(opcoes)}): ").strip()
        if escolha.isdigit():
            num = int(escolha)
            if 1 <= num <= len(opcoes):
                return opcoes[num-1]
        print(f"Opção inválida. Digite de 1 a {len(opcoes)}.")

def sim_ou_nao(pergunta):
    while True:
        r = input(pergunta + ' (s/n): ').lower().strip()
        if r in ['s', 'n']:
            return r == 's'
        print("Resposta inválida. Digite 's' para sim ou 'n' para não.")

def main():
    fontes = ["3d", "doom", "larry3d", "starwars", "cybermedium", "speed"]
    cores_dict = {
        "1": ("Ciano", "36"),
        "2": ("Azul", "34"),
        "3": ("Verde", "32"),
        "4": ("Magenta", "35"),
        "5": ("Amarelo", "33"),
        "6": ("Branco", "37"),
        "7": ("Azul Brilhante", "94"),
        "8": ("Verde Brilhante", "92"),
        "9": ("Ciano Brilhante", "96"),
        "10": ("Magenta Brilhante", "95")
    }
    cores = [v[0] for v in cores_dict.values()]

    nome = input("Digite seu nome para o banner: ").strip()
    fonte = escolher_lista_pergunta("Escolha a fonte do banner (estilo 3D/hack):", fontes)
    cor_banner = escolher_lista_pergunta("Escolha a cor do banner:", cores)
    cor_prompt = escolher_lista_pergunta("Escolha a cor do prompt (estilo Falcon hack):", cores)
    
    senha = ""
    if sim_ou_nao("Quer definir uma senha para abrir o Termux?"):
        import getpass
        senha = getpass.getpass("Digite a senha (não aparece ao digitar): ").strip()

    COR_BANNER_CODIGO = [v[1] for v in cores_dict.values() if v[0] == cor_banner][0]
    COR_PROMPT_CODIGO = [v[1] for v in cores_dict.values() if v[0] == cor_prompt][0]

    home = os.path.expanduser("~")
    config_path = os.path.join(home, ".termux_config")
    bashrc_path = os.path.join(home, ".bashrc")

    with open(config_path, "w") as f:
        f.write(f"NOME='{nome}'\n")
        f.write(f"SENHA='{senha}'\n")
        f.write(f"COR_BANNER='{COR_BANNER_CODIGO}'\n")
        f.write(f"COR_PROMPT='{COR_PROMPT_CODIGO}'\n")
        f.write(f"FONTE_BANNER='{fonte}'\n")

    bashrc_content = f'''
source ~/.termux_config
clear

typed_text() {{
  texto="$1"
  delay={{2:-0.07}}
  for ((i=0; i<{{#texto}}; i++)); do
    echo -n "{{{{texto:i:1}}}}"
    sleep $delay
  done
  echo ""
}}

echo -e "\\e[35m"
typed_text "Criado por Doctor Coringa Lunático..."
typed_text "O mestre das linhas de código obscuras."
typed_text "Aqui começa sua jornada hacker."
echo ""
typed_text "Aproveite e personalize sua área de trabalho ao máximo!"
echo -e "\\e[0m"
sleep 1
clear

echo -e "\\e[1;${{COR_BANNER}}m"
figlet -f "${{FONTE_BANNER}}" "${{NOME}}"
echo -e "\\e[0m"

if [ ! -z "${{SENHA}}" ]; then
  for i in {{1..3}}; do
    echo -n "Digite a senha para continuar: "
    read -s input_senha
    echo
    if [ "$input_senha" = "${{SENHA}}" ]; then
      break
    else
      echo "Senha incorreta. Tente novamente."
    fi
    if [ $i -eq 3 ]; then
      echo "Falha na autenticação, saindo..."
      exit 1
    fi
  done
fi

PS1="\\[\\033[1;${{COR_PROMPT}}m\\]${{NOME}} \\[\\033[0m\\]\\$ "
PROMPT_COMMAND='clear'
'''

    with open(bashrc_path, "w") as f:
        f.write(bashrc_content)

    print("Configuração salva com sucesso!")
    print("Reinicie o Termux para aplicar as alterações e ver seu painel personalizado.")

if __name__ == "__main__":
    main()
